import rollupPlugin from '@app-config/rollup';
export * from '@app-config/rollup';
export default function appConfigVite(options = {}) {
    const plugin = rollupPlugin(options);
    let watcher;
    return {
        ...plugin,
        name: '@app-config/vite',
        configureServer(server) {
            watcher = server.watcher;
        },
        async load(id) {
            var _a;
            const result = await plugin.load.call(this, id);
            watcher === null || watcher === void 0 ? void 0 : watcher.add((_a = plugin.currentFilePaths) !== null && _a !== void 0 ? _a : []);
            return result;
        },
        async handleHotUpdate({ server, file }) {
            var _a;
            if ((_a = plugin.currentFilePaths) === null || _a === void 0 ? void 0 : _a.includes(file)) {
                server.ws.send({ type: 'full-reload' });
                return [];
            }
        },
    };
}
//# sourceMappingURL=index.js.map
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const bson_1 = require("bson");
/* eslint-disable @typescript-eslint/no-unsafe-return */
const serialization = {
    serialize(data) {
        return bson_1.serialize(data);
    },
    async deserialize(data) {
        if (typeof data === 'string') {
            // we won't complain, just assume someone sent JSON
            return JSON.parse(data);
        }
        let buffer;
        if ('arrayBuffer' in data) {
            buffer = new Uint8Array(await data.arrayBuffer());
        }
        else if (data instanceof ArrayBuffer) {
            buffer = new Uint8Array(data);
        }
        else {
            buffer = data;
        }
        return bson_1.deserialize(buffer, { promoteBuffers: true });
    },
};
exports.default = serialization;
//# sourceMappingURL=bson.js.map